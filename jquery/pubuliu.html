<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>

    <script type="text/javascript" src="jquery.min.js"></script>
    <script type="text/javascript">

        $(document).ready(function () {

            $(window).on("load",function () {
                imgLocation();
            });

            var dataImg = {"data":[{"src":"1.jpg"},{"src":"2.jpg"},{"src":"3.jpg"},{"src":"4.jpg"},{"src":"5.jpg"}]};
            window.onscroll = function () {
                //console.log("===onscroll");
                if(scrollside()) {
                    //console.log("===onscroll");
                    $.each(dataImg.data,function (index,value) {
                        var box = $("<div>").addClass("box").appendTo($("#container"));
                        var content = $("<div>").addClass("content").appendTo(box);
                        var img = "./img/"+$(value).attr("src");
                        console.log("====img="+img);
                        $("<img>").attr("src",img).appendTo(content);
                    });
                    imgLocation();
                }
            };
        });


        function scrollside() {
            var box = $(".box");
            var lastBoxHeight = box.last().get(0).offsetTop + Math.floor(box.last().height()/2);
          //  console.log("====lastBoxHeight="+lastBoxHeight);
            var documentHeight = $(document).height();
            var scrollTop = $(window).scrollTop();
           // console.log("====new="+(scrollTop+documentHeight));

            return (lastBoxHeight < scrollTop+documentHeight) ? true : false;
        }
        
        function imgLocation() {
            var box = $(".box");
            var boxWidth = box.eq(0).width();
            var num = Math.floor($(window).width()/boxWidth);
            console.log("num="+num);

            var boxArr = [];
            box.each(function (index,value) {
               // console.log(index+"----"+value);
                var boxHeight = box.eq(index).height();
                if(index < num) {
                    boxArr[index] = boxHeight;
                    //console.log("boxHeight="+boxHeight+"index="+index);
                }else{
                    var minBoxHeight = Math.min.apply(null,boxArr);
                   // console.log("===minBoxHeight="+minBoxHeight);

                    var minboxIndex = $.inArray(minBoxHeight,boxArr);
                   // console.log("===minboxIndex="+minboxIndex);

                    $(value).css({
                        "position":"absolute",
                        "top":minBoxHeight,
                        "left":box.eq(minboxIndex).position().left
                    });

                    boxArr[minboxIndex]+= box.eq(index).height();
                }
            });

        }
    </script>
</head>

<body>

    <div id="container">
        <div class="box">
            <div class="content">
                <img src="img/1.jpg">
            </div>
        </div>

        <div class="box">
            <div class="content">
                <img src="img/2.jpg">
            </div>
        </div>

        <div class="box">
            <div class="content">
                <img src="img/3.jpg">
            </div>
        </div>

        <div class="box">
            <div class="content">
                <img src="img/4.jpg">
            </div>
        </div>

        <div class="box">
            <div class="content">
                <img src="img/5.jpg">
            </div>
        </div>

        <div class="box">
            <div class="content">
                <img src="img/6.jpg">
            </div>
        </div>

        <div class="box">
            <div class="content">
                <img src="img/7.jpg">
            </div>
        </div>

        <div class="box">
            <div class="content">
                <img src="img/8.jpg">
            </div>
        </div>

        <div class="box">
            <div class="content">
                <img src="img/9.jpg">
            </div>
        </div>

        <div class="box">
            <div class="content">
                <img src="img/10.jpg">
            </div>
        </div>
        <div class="box">
            <div class="content">
                <img src="img/1.jpg">
            </div>
        </div>

        <div class="box">
            <div class="content">
                <img src="img/2.jpg">
            </div>
        </div>

        <div class="box">
            <div class="content">
                <img src="img/3.jpg">
            </div>
        </div>

        <div class="box">
            <div class="content">
                <img src="img/4.jpg">
            </div>
        </div>

        <div class="box">
            <div class="content">
                <img src="img/5.jpg">
            </div>
        </div>

        <div class="box">
            <div class="content">
                <img src="img/6.jpg">
            </div>
        </div>

        <div class="box">
            <div class="content">
                <img src="img/7.jpg">
            </div>
        </div>

        <div class="box">
            <div class="content">
                <img src="img/8.jpg">
            </div>
        </div>

        <div class="box">
            <div class="content">
                <img src="img/9.jpg">
            </div>
        </div>

        <div class="box">
            <div class="content">
                <img src="img/10.jpg">
            </div>
        </div>
        <div class="box">
            <div class="content">
                <img src="img/1.jpg">
            </div>
        </div>

        <div class="box">
            <div class="content">
                <img src="img/2.jpg">
            </div>
        </div>

        <div class="box">
            <div class="content">
                <img src="img/3.jpg">
            </div>
        </div>

        <div class="box">
            <div class="content">
                <img src="img/4.jpg">
            </div>
        </div>

        <div class="box">
            <div class="content">
                <img src="img/5.jpg">
            </div>
        </div>

        <div class="box">
            <div class="content">
                <img src="img/6.jpg">
            </div>
        </div>

        <div class="box">
            <div class="content">
                <img src="img/7.jpg">
            </div>
        </div>

        <div class="box">
            <div class="content">
                <img src="img/8.jpg">
            </div>
        </div>

        <div class="box">
            <div class="content">
                <img src="img/9.jpg">
            </div>
        </div>

        <div class="box">
            <div class="content">
                <img src="img/10.jpg">
            </div>
        </div>

    </div>

</body>
<link rel="stylesheet" type="text/css" href="test.css">
</html>